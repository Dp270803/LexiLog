<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LexiLog - Personal Vocabulary Builder</title>
    
    <style>
        /* Complete CSS Reset and Base Styles */
        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        html {
            line-height: 1.5;
            -webkit-text-size-adjust: 100%;
            font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif;
        }
        
        body {
            margin: 0;
            line-height: inherit;
            background-color: #f9fafb;
            min-height: 100vh;
        }
        
        /* Utility Classes */
        .fixed { position: fixed; }
        .absolute { position: absolute; }
        .relative { position: relative; }
        .inset-0 { top: 0; right: 0; bottom: 0; left: 0; }
        .z-50 { z-index: 50; }
        .z-10 { z-index: 10; }
        .flex { display: flex; }
        .grid { display: grid; }
        .hidden { display: none; }
        .block { display: block; }
        .h-full { height: 100%; }
        .h-screen { height: 100vh; }
        .min-h-screen { min-height: 100vh; }
        .w-full { width: 100%; }
        .max-w-md { max-width: 28rem; }
        .max-w-4xl { max-width: 56rem; }
        .max-w-6xl { max-width: 72rem; }
        .max-w-2xl { max-width: 42rem; }
        .mx-4 { margin-left: 1rem; margin-right: 1rem; }
        .mx-auto { margin-left: auto; margin-right: auto; }
        .mb-2 { margin-bottom: 0.5rem; }
        .mb-4 { margin-bottom: 1rem; }
        .mb-6 { margin-bottom: 1.5rem; }
        .mb-8 { margin-bottom: 2rem; }
        .mt-6 { margin-top: 1.5rem; }
        .items-center { align-items: center; }
        .justify-center { justify-content: center; }
        .justify-between { justify-content: space-between; }
        .space-y-4 > :not([hidden]) ~ :not([hidden]) { margin-top: 1rem; }
        .space-y-6 > :not([hidden]) ~ :not([hidden]) { margin-top: 1.5rem; }
        .space-x-1 > :not([hidden]) ~ :not([hidden]) { margin-left: 0.25rem; }
        .rounded-lg { border-radius: 0.5rem; }
        .rounded-xl { border-radius: 0.75rem; }
        .rounded-2xl { border-radius: 1rem; }
        .rounded-3xl { border-radius: 1.5rem; }
        .border { border-width: 1px; }
        .border-gray-300 { border-color: #d1d5db; }
        .bg-gray-50 { background-color: #f9fafb; }
        .bg-white { background-color: #fff; }
        .bg-blue-600 { background-color: #2563eb; }
        .bg-gradient-to-r { background-image: linear-gradient(to right, var(--tw-gradient-stops)); }
        .from-blue-600 { --tw-gradient-from: #2563eb; --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, rgba(37,99,235,0)); }
        .to-purple-600 { --tw-gradient-to: #9333ea; }
        .bg-clip-text { -webkit-background-clip: text; background-clip: text; }
        .p-4 { padding: 1rem; }
        .p-6 { padding: 1.5rem; }
        .p-8 { padding: 2rem; }
        .px-4 { padding-left: 1rem; padding-right: 1rem; }
        .px-6 { padding-left: 1.5rem; padding-right: 1.5rem; }
        .py-3 { padding-top: 0.75rem; padding-bottom: 0.75rem; }
        .py-4 { padding-top: 1rem; padding-bottom: 1rem; }
        .py-20 { padding-top: 5rem; padding-bottom: 5rem; }
        .text-center { text-align: center; }
        .text-sm { font-size: 0.875rem; line-height: 1.25rem; }
        .text-lg { font-size: 1.125rem; line-height: 1.75rem; }
        .text-xl { font-size: 1.25rem; line-height: 1.75rem; }
        .text-2xl { font-size: 1.5rem; line-height: 2rem; }
        .text-3xl { font-size: 1.875rem; line-height: 2.25rem; }
        .text-4xl { font-size: 2.25rem; line-height: 2.5rem; }
        .text-5xl { font-size: 3rem; line-height: 1; }
        .text-6xl { font-size: 3.75rem; line-height: 1; }
        .font-medium { font-weight: 500; }
        .font-semibold { font-weight: 600; }
        .font-bold { font-weight: 700; }
        .text-gray-600 { color: #4b5563; }
        .text-gray-700 { color: #374151; }
        .text-gray-800 { color: #1f2937; }
        .text-white { color: #fff; }
        .text-transparent { color: transparent; }
        .shadow-lg { box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1), 0 4px 6px -2px rgba(0,0,0,0.05); }
        .shadow-2xl { box-shadow: 0 25px 50px -12px rgba(0,0,0,0.25); }
        .hover\:bg-blue-700:hover { background-color: #1d4ed8; }
        .focus\:ring-2:focus { box-shadow: 0 0 0 3px rgba(59,130,246,0.5); }
        .focus\:ring-blue-500:focus { --tw-ring-color: #3b82f6; }
        .focus\:border-transparent:focus { border-color: transparent; }
        .transition-colors { transition-property: color, background-color, border-color; transition-duration: 150ms; }
        .grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
        .gap-6 { gap: 1.5rem; }
        .transform { transform: var(--tw-transform); }
        .hover\:scale-105:hover { --tw-scale-x: 1.05; --tw-scale-y: 1.05; transform: scale(1.05); }
        .hover\:-translate-y-1:hover { transform: translateY(-0.25rem); }
        .transition-all { transition-property: all; transition-duration: 150ms; }
        .duration-300 { transition-duration: 300ms; }
        .cursor-pointer { cursor: pointer; }
        
        /* Input styles */
        input, select, textarea {
            font-family: inherit;
            font-size: 100%;
            font-weight: inherit;
            line-height: inherit;
            color: inherit;
            margin: 0;
            padding: 0;
            border: 1px solid #d1d5db;
            border-radius: 0.5rem;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(59,130,246,0.5);
            border-color: transparent;
        }
        
        button {
            font-family: inherit;
            font-size: 100%;
            font-weight: inherit;
            line-height: inherit;
            color: inherit;
            margin: 0;
            padding: 0;
            background-color: transparent;
            background-image: none;
            cursor: pointer;
            border: none;
        }
        
        /* Beautiful Animations from original styles.css */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes floating {
            0%, 100% {
                transform: translateY(0px) rotate(0deg);
            }
            33% {
                transform: translateY(-20px) rotate(5deg);
            }
            66% {
                transform: translateY(-10px) rotate(-5deg);
            }
        }
        
        @keyframes pulse-glow {
            0%, 100% {
                box-shadow: 0 0 20px rgba(59, 130, 246, 0.3);
            }
            50% {
                box-shadow: 0 0 40px rgba(59, 130, 246, 0.6);
            }
        }
        
        @keyframes gradient-shift {
            0% {
                background-position: 0% 50%;
            }
            50% {
                background-position: 100% 50%;
            }
            100% {
                background-position: 0% 50%;
            }
        }
        
        /* Animation Classes */
        .animate-fade-in-up {
            animation: fadeInUp 0.8s ease-out forwards;
        }
        
        .animate-floating {
            animation: floating 6s ease-in-out infinite;
        }
        
        .animate-pulse-glow {
            animation: pulse-glow 2s ease-in-out infinite;
        }
        
        .animate-gradient {
            background-size: 400% 400%;
            animation: gradient-shift 3s ease infinite;
        }
        
        /* Mobile responsive overrides */
        @media (max-width: 768px) {
            .max-w-md { max-width: 90%; }
            .max-w-4xl, .max-w-6xl, .max-w-2xl { max-width: 95%; }
            .p-8 { padding: 1.5rem; }
            .px-4 { padding-left: 1rem; padding-right: 1rem; }
            .py-20 { padding-top: 3rem; padding-bottom: 3rem; }
            .text-6xl { font-size: 2.5rem; line-height: 1.1; }
            .text-5xl { font-size: 2rem; line-height: 1.2; }
            .text-4xl { font-size: 1.75rem; line-height: 1.3; }
            .text-3xl { font-size: 1.5rem; line-height: 1.4; }
            .grid-cols-2 { grid-template-columns: 1fr; }
            .gap-6 { gap: 1rem; }
            .rounded-3xl { border-radius: 1rem; }
            .shadow-2xl { box-shadow: 0 10px 25px -3px rgba(0,0,0,0.1), 0 4px 6px -2px rgba(0,0,0,0.05); }
        }
        
        /* Ensure inputs work properly on mobile */
        @media (max-width: 768px) {
            input[type="text"], input[type="email"], input[type="password"], select {
                font-size: 16px !important; /* Prevent zoom on iOS */
                padding: 12px !important;
                min-height: 44px !important; /* Touch target size */
            }
            
            button {
                min-height: 44px !important;
                padding: 12px 16px !important;
            }
        }
    </style>
    
    <!-- Firebase Scripts -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
</head>
<body class="bg-gray-50 min-h-screen">
    <div style="position: fixed; top: 10px; right: 10px; background: #000; color: #fff; padding: 5px 10px; border-radius: 5px; font-size: 12px; z-index: 999;">
        FRESH: 20250831004132
    </div>
    
    <!-- Authentication Views -->
    <!-- Login View -->
    <div id="loginView" class="fixed inset-0 bg-gray-50 z-50 flex items-center justify-center">
        <div class="max-w-md w-full mx-4 p-8 bg-white rounded-lg shadow-lg animate-fade-in-up">
            <div class="text-center mb-8">
                <h1 class="text-3xl font-bold text-gray-800 mb-2">Welcome Back</h1>
                <p class="text-gray-600">Sign in to your LexiLog account</p>
            </div>
            <form id="loginForm" class="space-y-6">
                <div>
                    <label for="loginEmail" class="block text-sm font-medium text-gray-700 mb-2">
                        Email Address
                    </label>
                    <input 
                        type="email" 
                        id="loginEmail" 
                        name="email" 
                        required
                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        placeholder="Enter your email"
                    >
                </div>
                <div>
                    <label for="loginPassword" class="block text-sm font-medium text-gray-700 mb-2">
                        Password
                    </label>
                    <input 
                        type="password" 
                        id="loginPassword" 
                        name="password" 
                        required
                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        placeholder="Enter your password"
                    >
                </div>
                <button 
                    type="submit" 
                    id="loginButton"
                    class="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-4 rounded-lg transition-colors"
                >
                    Sign In
                </button>
            </form>
            <div class="mt-6 text-center">
                <p class="text-gray-600">
                    Don't have an account? 
                    <button id="showSignupBtn" class="text-blue-600 font-semibold cursor-pointer">Sign up</button>
                </p>
            </div>
        </div>
    </div>

    <!-- Signup View -->
    <div id="signupView" class="hidden fixed inset-0 bg-gray-50 z-50 flex items-center justify-center">
        <div class="max-w-md w-full mx-4 p-8 bg-white rounded-lg shadow-lg animate-fade-in-up">
            <div class="text-center mb-6">
                <h1 class="text-2xl font-bold text-gray-800 mb-2">Join LexiLog</h1>
                <p class="text-gray-600">Create your account and start building your vocabulary</p>
            </div>
            
            <form id="signupForm" class="space-y-4">
                <div>
                    <label for="signupName" class="block text-sm font-medium text-gray-700 mb-2">Full Name</label>
                    <input 
                        type="text" 
                        id="signupName" 
                        required
                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        placeholder="Enter your full name"
                    >
                </div>
                
                <div>
                    <label for="signupEmail" class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                    <input 
                        type="email" 
                        id="signupEmail" 
                        required
                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        placeholder="Enter your email"
                    >
                </div>
                
                <div>
                    <label for="signupPassword" class="block text-sm font-medium text-gray-700 mb-2">Password</label>
                    <input 
                        type="password" 
                        id="signupPassword" 
                        required
                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        placeholder="Create a password"
                    >
                </div>
                
                <div>
                    <label for="signupQuestion" class="block text-sm font-medium text-gray-700 mb-2">
                        What are you preparing for?
                    </label>
                    <select 
                        id="signupQuestion" 
                        name="goal" 
                        required
                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                    >
                        <option value="">Select your goal</option>
                        <option value="cat">🐯 CAT (Common Admission Test)</option>
                        <option value="gre">🎓 GRE (Graduate Record Examination)</option>
                        <option value="gmat">📊 GMAT (Graduate Management Admission Test)</option>
                        <option value="upsc">🏛️ UPSC Civil Services</option>
                        <option value="banking">🏦 Banking Exams (IBPS, SBI PO/Clerk)</option>
                        <option value="ssc">📝 SSC Exams (CGL, CHSL, MTS)</option>
                        <option value="gate">⚙️ GATE (Graduate Aptitude Test in Engineering)</option>
                        <option value="ielts">🌍 IELTS (International English Language Testing System)</option>
                        <option value="toefl">🇺🇸 TOEFL (Test of English as a Foreign Language)</option>
                        <option value="sat">📚 SAT (Scholastic Assessment Test)</option>
                        <option value="act">📝 ACT (American College Testing)</option>
                        <option value="clat">⚖️ CLAT (Common Law Admission Test)</option>
                        <option value="neet">🏥 NEET (National Eligibility cum Entrance Test)</option>
                        <option value="jee">🔬 JEE (Joint Entrance Examination)</option>
                        <option value="vocabulary-building">📖 Just Building My Vocabulary</option>
                        <option value="other">✏️ Other</option>
                    </select>
                </div>
                
                <div id="otherGoalField" class="hidden">
                    <label for="signupOtherGoal" class="block text-sm font-medium text-gray-700 mb-2">
                        Please specify your exam/goal:
                    </label>
                    <input 
                        type="text" 
                        id="signupOtherGoal" 
                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        placeholder="e.g., UPSC, CAT 2024, etc."
                    >
                </div>
                
                <button 
                    type="submit" 
                    id="signupButton"
                    class="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-4 rounded-lg transition-colors"
                >
                    Create Account
                </button>
            </form>
            
            <div class="mt-6 text-center">
                <p class="text-gray-600">
                    Already have an account? 
                    <button id="showLoginBtn" class="text-blue-600 font-semibold cursor-pointer">Sign in</button>
                </p>
            </div>
        </div>
    </div>

    <!-- Main App -->
    <div id="mainApp" class="hidden">
        <!-- Homepage -->
        <div id="homeView" class="min-h-screen bg-gray-50 py-20">
            <div class="max-w-6xl mx-auto px-4">
                <div class="text-center mb-8 animate-fade-in-up">
                    <h1 id="greeting" class="text-5xl md:text-6xl font-bold mb-4">
                        <span class="bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent animate-gradient">
                            Welcome to LexiLog!
                        </span>
                    </h1>
                    <p class="text-xl text-gray-600">Your Personal Vocabulary Builder</p>
                </div>
                
                <div class="grid grid-cols-2 gap-6 max-w-4xl mx-auto">
                    <div class="bg-gradient-to-br from-blue-500 to-blue-600 text-white p-8 rounded-3xl shadow-2xl cursor-pointer transform hover:scale-105 hover:-translate-y-1 transition-all duration-300 animate-floating" 
                         onclick="navigateToView('dictionary')" style="animation-delay: 0.1s;">
                        <div class="text-4xl mb-4">📚</div>
                        <h3 class="text-2xl font-bold mb-2">Smart Dictionary</h3>
                        <p class="text-blue-100">Search English words with definitions, phonetics, and audio pronunciation</p>
                    </div>
                    
                    <div class="bg-gradient-to-br from-green-500 to-emerald-600 text-white p-8 rounded-3xl shadow-2xl cursor-pointer transform hover:scale-105 hover:-translate-y-1 transition-all duration-300 animate-floating" 
                         onclick="navigateToView('library')" style="animation-delay: 0.2s;">
                        <div class="text-4xl mb-4">📖</div>
                        <h3 class="text-2xl font-bold mb-2">My LexiLog</h3>
                        <p class="text-green-100">Access your saved vocabulary and track your learning progress</p>
                    </div>
                    
                    <div class="bg-gradient-to-br from-purple-500 to-pink-500 text-white p-8 rounded-3xl shadow-2xl cursor-pointer transform hover:scale-105 hover:-translate-y-1 transition-all duration-300 animate-floating" 
                         onclick="navigateToView('languages')" style="animation-delay: 0.3s;">
                        <div class="text-4xl mb-4">🌍</div>
                        <h3 class="text-2xl font-bold mb-2">Other Languages</h3>
                        <p class="text-purple-100">Search words in 20+ languages with translations and definitions</p>
                    </div>
                    
                    <div class="bg-gradient-to-br from-orange-500 to-red-500 text-white p-8 rounded-3xl shadow-2xl cursor-pointer transform hover:scale-105 hover:-translate-y-1 transition-all duration-300 animate-floating" 
                         onclick="navigateToView('daily')" style="animation-delay: 0.4s;">
                        <div class="text-4xl mb-4">⭐</div>
                        <h3 class="text-2xl font-bold mb-2">Word of the Day</h3>
                        <p class="text-orange-100">Discover and learn a new word every day to expand your vocabulary</p>
                    </div>
                </div>
                
                <div class="text-center mt-8">
                    <button onclick="logout()" class="bg-red-500 hover:bg-red-600 text-white px-6 py-2 rounded-lg transition-colors">
                        Logout
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Simple placeholder views for now -->
        <div id="dictionaryView" class="hidden min-h-screen bg-gray-50 py-20">
            <div class="max-w-2xl mx-auto px-4 text-center">
                <h2 class="text-3xl font-bold mb-4">📚 Dictionary</h2>
                <p class="text-gray-600 mb-6">Search for English words</p>
                <input type="text" id="searchInput" placeholder="Enter a word..." class="w-full px-4 py-3 border rounded-lg mb-4">
                <button onclick="searchWord()" class="bg-blue-600 text-white px-6 py-3 rounded-lg">Search</button>
                <div id="searchResults" class="mt-6 hidden bg-white p-6 rounded-lg shadow-lg">
                    <h3 id="resultWord" class="text-xl font-bold mb-2"></h3>
                    <p id="resultDefinition" class="text-gray-700"></p>
                </div>
                <button onclick="navigateToView('home')" class="mt-6 bg-gray-500 text-white px-4 py-2 rounded-lg">Back to Home</button>
            </div>
        </div>
        
        <div id="libraryView" class="hidden min-h-screen bg-gray-50 py-20">
            <div class="max-w-2xl mx-auto px-4 text-center">
                <h2 class="text-3xl font-bold mb-4">📖 My LexiLog</h2>
                <p class="text-gray-600 mb-6">Your saved vocabulary</p>
                <div id="vocabularyList">Loading...</div>
                <button onclick="navigateToView('home')" class="mt-6 bg-gray-500 text-white px-4 py-2 rounded-lg">Back to Home</button>
            </div>
        </div>
        
        <div id="languagesView" class="hidden min-h-screen bg-gray-50 py-20">
            <div class="max-w-2xl mx-auto px-4 text-center">
                <h2 class="text-3xl font-bold mb-4">🌍 Other Languages</h2>
                <p class="text-gray-600 mb-6">Multi-language search</p>
                <p class="text-gray-500">Coming soon...</p>
                <button onclick="navigateToView('home')" class="mt-6 bg-gray-500 text-white px-4 py-2 rounded-lg">Back to Home</button>
            </div>
        </div>
        
        <div id="dailyView" class="hidden min-h-screen bg-gray-50 py-20">
            <div class="max-w-2xl mx-auto px-4 text-center">
                <h2 class="text-3xl font-bold mb-4">⭐ Word of the Day</h2>
                <p class="text-gray-600 mb-6">Daily vocabulary boost</p>
                <div id="dailyWordCard" class="bg-white p-6 rounded-lg shadow-lg">
                    <div class="text-2xl font-bold mb-2" id="dailyWord">Loading...</div>
                    <div id="dailyDefinition" class="text-gray-700"></div>
                </div>
                <button onclick="navigateToView('home')" class="mt-6 bg-gray-500 text-white px-4 py-2 rounded-lg">Back to Home</button>
            </div>
        </div>
    </div>

    <script>
        console.log('🚀 LexiLog FRESH VERSION - Loading...');
        
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyByQABCkc1kQgSZevk30UKWQe3dq0bhHbs",
            authDomain: "lexilog-c1559.firebaseapp.com",
            projectId: "lexilog-c1559",
            storageBucket: "lexilog-c1559.firebasestorage.app",
            messagingSenderId: "383823777893",
            appId: "1:383823777893:web:ffe084adfbf2d1ee7cf68c",
            measurementId: "G-QXMEFRQ36N"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        let currentUser = null;
        let currentUserId = null;

        // View management
        function navigateToView(viewName) {
            console.log('🔄 Navigating to:', viewName);
            
            // Hide all views
            const views = ['home', 'dictionary', 'library', 'languages', 'daily'];
            views.forEach(view => {
                const viewElement = document.getElementById(view + 'View');
                if (viewElement) {
                    viewElement.classList.add('hidden');
                }
            });
            
            // Show target view
            const targetView = document.getElementById(viewName + 'View');
            if (targetView) {
                targetView.classList.remove('hidden');
            }
        }

        // Show main app
        function showMainApp(userProfile) {
            console.log('🏠 Showing main app');
            document.getElementById('loginView').classList.add('hidden');
            document.getElementById('signupView').classList.add('hidden');
            document.getElementById('mainApp').classList.remove('hidden');
            
            if (userProfile && userProfile.name) {
                const firstName = userProfile.name.split(' ')[0];
                document.getElementById('greeting').innerHTML = `
                    <span class="bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent animate-gradient">
                        Welcome to LexiLog, ${firstName}!
                    </span>
                `;
            }
            
            navigateToView('home');
        }

        // Show login
        function showLogin() {
            console.log('🔑 Showing login');
            document.getElementById('loginView').classList.remove('hidden');
            document.getElementById('signupView').classList.add('hidden');
            document.getElementById('mainApp').classList.add('hidden');
        }

        // Show signup
        function showSignup() {
            console.log('📝 Showing signup');
            document.getElementById('signupView').classList.remove('hidden');
            document.getElementById('loginView').classList.add('hidden');
            document.getElementById('mainApp').classList.add('hidden');
        }

        // Authentication state listener
        auth.onAuthStateChanged(async (user) => {
            console.log('🔐 Auth state changed:', user ? 'User logged in' : 'User logged out');
            
            if (user) {
                currentUser = user;
                currentUserId = user.uid;
                
                try {
                    const doc = await db.collection('artifacts').doc('lexilog-vocabulary-builder')
                        .collection('users').doc(currentUserId)
                        .collection('profile').doc('data').get();
                    
                    if (doc.exists) {
                        showMainApp(doc.data());
                    } else {
                        showMainApp({ name: user.email.split('@')[0] });
                    }
                } catch (error) {
                    console.error('Profile loading error:', error);
                    showMainApp({ name: user.email.split('@')[0] });
                }
            } else {
                showLogin();
            }
        });

        // Event listeners
        document.addEventListener('DOMContentLoaded', () => {
            console.log('📱 DOM loaded, setting up events...');
            
            // Login/Signup navigation
            document.getElementById('showSignupBtn').addEventListener('click', showSignup);
            document.getElementById('showLoginBtn').addEventListener('click', showLogin);

            // Login form
            document.getElementById('loginForm').addEventListener('submit', async (e) => {
                e.preventDefault();
                const email = document.getElementById('loginEmail').value.trim();
                const password = document.getElementById('loginPassword').value;
                
                console.log('🔑 Attempting login...');
                
                try {
                    await auth.signInWithEmailAndPassword(email, password);
                    console.log('✅ Login successful');
                } catch (error) {
                    console.error('❌ Login error:', error);
                    alert('Login failed: ' + error.message);
                }
            });

            // Signup form
            document.getElementById('signupForm').addEventListener('submit', async (e) => {
                e.preventDefault();
                const name = document.getElementById('signupName').value.trim();
                const email = document.getElementById('signupEmail').value.trim();
                const password = document.getElementById('signupPassword').value;
                const goal = document.getElementById('signupQuestion').value;
                const otherGoal = document.getElementById('signupOtherGoal').value.trim();
                
                console.log('📝 Creating account...');
                
                try {
                    const result = await auth.createUserWithEmailAndPassword(email, password);
                    
                    // Save profile
                    await db.collection('artifacts').doc('lexilog-vocabulary-builder')
                        .collection('users').doc(result.user.uid)
                        .collection('profile').doc('data').set({
                            name: name,
                            email: email,
                            goal: goal,
                            otherGoal: otherGoal,
                            createdAt: firebase.firestore.FieldValue.serverTimestamp()
                        });

                    console.log('✅ Account created successfully');
                } catch (error) {
                    console.error('❌ Signup error:', error);
                    alert('Signup failed: ' + error.message);
                }
            });

            // Goal selector
            document.getElementById('signupQuestion').addEventListener('change', (e) => {
                const otherField = document.getElementById('otherGoalField');
                const otherInput = document.getElementById('signupOtherGoal');
                
                if (e.target.value === 'other') {
                    otherField.classList.remove('hidden');
                    otherInput.required = true;
                } else {
                    otherField.classList.add('hidden');
                    otherInput.required = false;
                    otherInput.value = '';
                }
            });
        });

        // Logout function
        function logout() {
            console.log('👋 Logging out...');
            auth.signOut();
        }

        // Simple search function
        async function searchWord() {
            const word = document.getElementById('searchInput').value.trim();
            if (!word) return;
            
            console.log('🔍 Searching for:', word);
            
            try {
                const response = await fetch(`https://api.dictionaryapi.dev/api/v2/entries/en/${encodeURIComponent(word)}`);
                if (response.ok) {
                    const data = await response.json();
                    if (data && data[0]) {
                        document.getElementById('resultWord').textContent = data[0].word;
                        document.getElementById('resultDefinition').textContent = 
                            data[0].meanings[0].definitions[0].definition;
                        document.getElementById('searchResults').classList.remove('hidden');
                        console.log('✅ Word found');
                    }
                } else {
                    alert('Word not found');
                }
            } catch (error) {
                console.error('❌ Search error:', error);
                alert('Search failed');
            }
        }

        // Load daily word
        function loadDailyWord() {
            const words = ['serendipity', 'eloquent', 'ubiquitous', 'pragmatic', 'ephemeral'];
            const randomWord = words[Math.floor(Math.random() * words.length)];
            
            fetch(`https://api.dictionaryapi.dev/api/v2/entries/en/${randomWord}`)
                .then(response => response.json())
                .then(data => {
                    if (data && data[0]) {
                        document.getElementById('dailyWord').textContent = data[0].word;
                        document.getElementById('dailyDefinition').textContent = 
                            data[0].meanings[0].definitions[0].definition;
                    }
                })
                .catch(error => console.error('Daily word error:', error));
        }

        // Initialize
        console.log('✨ LexiLog FRESH VERSION - Ready!');
    </script>
</body>
</html>
