<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LexiLog Mobile Debug</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f0f0f0;
        }
        .debug-section {
            background: white;
            margin: 10px 0;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .error { color: red; }
        .success { color: green; }
        .warning { color: orange; }
        pre { background: #f5f5f5; padding: 10px; border-radius: 4px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>üîç LexiLog Mobile Debug</h1>
    
    <div class="debug-section">
        <h3>üì± Device Info</h3>
        <div id="deviceInfo"></div>
    </div>
    
    <div class="debug-section">
        <h3>üåê Network Status</h3>
        <div id="networkStatus"></div>
    </div>
    
    <div class="debug-section">
        <h3>üîß JavaScript Errors</h3>
        <div id="jsErrors"></div>
    </div>
    
    <div class="debug-section">
        <h3>üì¶ Resource Loading</h3>
        <div id="resourceStatus"></div>
    </div>
    
    <div class="debug-section">
        <h3>üî• Firebase Status</h3>
        <div id="firebaseStatus"></div>
    </div>
    
    <div class="debug-section">
        <h3>üéØ Test Basic Functionality</h3>
        <button onclick="testBasicJS()" style="padding: 10px 20px; background: #3B82F6; color: white; border: none; border-radius: 4px;">Test JavaScript</button>
        <button onclick="testFirebase()" style="padding: 10px 20px; background: #10B981; color: white; border: none; border-radius: 4px; margin-left: 10px;">Test Firebase</button>
        <div id="testResults" style="margin-top: 10px;"></div>
    </div>

    <script>
        // Capture all errors
        const errors = [];
        window.addEventListener('error', (e) => {
            errors.push({
                message: e.message,
                filename: e.filename,
                lineno: e.lineno,
                colno: e.colno,
                stack: e.error ? e.error.stack : 'No stack trace'
            });
            updateErrorDisplay();
        });

        window.addEventListener('unhandledrejection', (e) => {
            errors.push({
                message: 'Promise rejection: ' + e.reason,
                type: 'promise'
            });
            updateErrorDisplay();
        });

        function updateErrorDisplay() {
            const errorDiv = document.getElementById('jsErrors');
            if (errors.length === 0) {
                errorDiv.innerHTML = '<span class="success">‚úÖ No JavaScript errors detected</span>';
            } else {
                errorDiv.innerHTML = '<span class="error">‚ùå JavaScript Errors:</span><br>' + 
                    errors.map(err => `<pre>${JSON.stringify(err, null, 2)}</pre>`).join('');
            }
        }

        // Device info
        function displayDeviceInfo() {
            const info = {
                userAgent: navigator.userAgent,
                viewport: `${window.innerWidth}x${window.innerHeight}`,
                devicePixelRatio: window.devicePixelRatio,
                online: navigator.onLine,
                language: navigator.language,
                platform: navigator.platform,
                cookieEnabled: navigator.cookieEnabled,
                javaEnabled: navigator.javaEnabled ? navigator.javaEnabled() : 'N/A'
            };
            
            document.getElementById('deviceInfo').innerHTML = Object.entries(info)
                .map(([key, value]) => `<strong>${key}:</strong> ${value}`).join('<br>');
        }

        // Network status
        function displayNetworkStatus() {
            const status = navigator.onLine ? 
                '<span class="success">‚úÖ Online</span>' : 
                '<span class="error">‚ùå Offline</span>';
            document.getElementById('networkStatus').innerHTML = status;
        }

        // Resource loading test
        function testResourceLoading() {
            const resources = [
                'https://cdn.tailwindcss.com',
                'https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js',
                'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js',
                'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js'
            ];

            const statusDiv = document.getElementById('resourceStatus');
            statusDiv.innerHTML = 'Testing resource loading...';

            Promise.allSettled(resources.map(url => 
                fetch(url, { method: 'HEAD' }).then(r => ({ url, status: r.status, ok: r.ok }))
            )).then(results => {
                statusDiv.innerHTML = results.map(result => {
                    if (result.status === 'fulfilled') {
                        const { url, status, ok } = result.value;
                        const statusText = ok ? 
                            `<span class="success">‚úÖ ${status}</span>` : 
                            `<span class="error">‚ùå ${status}</span>`;
                        return `${url.split('/').pop()}: ${statusText}`;
                    } else {
                        return `<span class="error">‚ùå Failed to test: ${result.reason}</span>`;
                    }
                }).join('<br>');
            });
        }

        // Firebase test
        function testFirebase() {
            const resultsDiv = document.getElementById('testResults');
            resultsDiv.innerHTML = 'Testing Firebase...';

            if (typeof firebase === 'undefined') {
                resultsDiv.innerHTML = '<span class="error">‚ùå Firebase not loaded</span>';
                return;
            }

            try {
                // Test Firebase config
                const config = {
                    apiKey: "AIzaSyByQABCkc1kQgSZevk30UKWQe3dq0bhHbs",
                    authDomain: "lexilog-c1559.firebaseapp.com",
                    projectId: "lexilog-c1559",
                    storageBucket: "lexilog-c1559.firebasestorage.app",
                    messagingSenderId: "383823777893",
                    appId: "1:383823777893:web:ffe084adfbf2d1ee7cf68c",
                    measurementId: "G-QXMEFRQ36N"
                };

                firebase.initializeApp(config);
                const auth = firebase.auth();
                const db = firebase.firestore();

                resultsDiv.innerHTML = '<span class="success">‚úÖ Firebase initialized successfully</span>';
            } catch (error) {
                resultsDiv.innerHTML = `<span class="error">‚ùå Firebase error: ${error.message}</span>`;
            }
        }

        // Basic JS test
        function testBasicJS() {
            const resultsDiv = document.getElementById('testResults');
            try {
                // Test basic JS features
                const testArray = [1, 2, 3];
                const testPromise = Promise.resolve('test');
                const testAsync = async () => 'async works';
                
                resultsDiv.innerHTML = '<span class="success">‚úÖ Basic JavaScript working</span>';
            } catch (error) {
                resultsDiv.innerHTML = `<span class="error">‚ùå JavaScript error: ${error.message}</span>`;
            }
        }

        // Initialize debug info
        document.addEventListener('DOMContentLoaded', () => {
            displayDeviceInfo();
            displayNetworkStatus();
            testResourceLoading();
            updateErrorDisplay();
            
            // Update network status on change
            window.addEventListener('online', displayNetworkStatus);
            window.addEventListener('offline', displayNetworkStatus);
        });

        // Load Firebase for testing
        const script = document.createElement('script');
        script.src = 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js';
        script.onload = () => {
            const authScript = document.createElement('script');
            authScript.src = 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js';
            authScript.onload = () => {
                const firestoreScript = document.createElement('script');
                firestoreScript.src = 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js';
                firestoreScript.onload = () => {
                    document.getElementById('firebaseStatus').innerHTML = '<span class="success">‚úÖ Firebase scripts loaded</span>';
                };
                firestoreScript.onerror = () => {
                    document.getElementById('firebaseStatus').innerHTML = '<span class="error">‚ùå Firestore script failed to load</span>';
                };
                document.head.appendChild(firestoreScript);
            };
            authScript.onerror = () => {
                document.getElementById('firebaseStatus').innerHTML = '<span class="error">‚ùå Firebase Auth script failed to load</span>';
            };
            document.head.appendChild(authScript);
        };
        script.onerror = () => {
            document.getElementById('firebaseStatus').innerHTML = '<span class="error">‚ùå Firebase core script failed to load</span>';
        };
        document.head.appendChild(script);
    </script>
</body>
</html>
