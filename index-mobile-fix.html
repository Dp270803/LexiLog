<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LexiLog - Personal Vocabulary Builder</title>
    
    <!-- Embedded Tailwind CSS - No CDN dependency -->
    <style>
        *,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}::after,::before{--tw-content:''}html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji"}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace,SFMono-Regular,"Consolas","Liberation Mono","Menlo",monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;font-weight:inherit;line-height:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]{display:none}

        /* Essential Tailwind utilities */
        .bg-gray-50{background-color:#f9fafb}
        .min-h-screen{min-height:100vh}
        .hidden{display:none}
        .fixed{position:fixed}
        .inset-0{top:0;right:0;bottom:0;left:0}
        .z-50{z-index:50}
        .flex{display:flex}
        .items-center{align-items:center}
        .justify-center{justify-content:center}
        .p-8{padding:2rem}
        .bg-white{background-color:#fff}
        .rounded-2xl{border-radius:1rem}
        .shadow-2xl{box-shadow:0 25px 50px -12px rgba(0,0,0,.25)}
        .max-w-md{max-width:28rem}
        .w-full{width:100%}
        .text-center{text-align:center}
        .mb-8{margin-bottom:2rem}
        .text-3xl{font-size:1.875rem;line-height:2.25rem}
        .font-bold{font-weight:700}
        .bg-gradient-to-r{background-image:linear-gradient(to right,var(--tw-gradient-stops))}
        .from-blue-600{--tw-gradient-from:#2563eb;--tw-gradient-stops:var(--tw-gradient-from),var(--tw-gradient-to,rgba(37,99,235,0))}
        .to-purple-600{--tw-gradient-to:#9333ea}
        .bg-clip-text{-webkit-background-clip:text;background-clip:text}
        .text-transparent{color:transparent}
        .mb-6{margin-bottom:1.5rem}
        .space-y-4>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-top:calc(1rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1rem * var(--tw-space-y-reverse))}
        .block{display:block}
        .text-sm{font-size:.875rem;line-height:1.25rem}
        .font-medium{font-weight:500}
        .text-gray-700{color:#374151}
        .px-4{padding-left:1rem;padding-right:1rem}
        .py-3{padding-top:.75rem;padding-bottom:.75rem}
        .border{border-width:1px}
        .border-gray-300{border-color:#d1d5db}
        .rounded-lg{border-radius:.5rem}
        .focus\:ring-2:focus{box-shadow:0 0 0 3px rgba(59,130,246,.5)}
        .focus\:ring-blue-500:focus{--tw-ring-color:#3b82f6}
        .focus\:border-transparent:focus{border-color:transparent}
        .bg-blue-600{background-color:#2563eb}
        .hover\:bg-blue-700:hover{background-color:#1d4ed8}
        .text-white{color:#fff}
        .font-semibold{font-weight:600}
        .transition-colors{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}
        .text-blue-600{color:#2563eb}
        .hover\:text-blue-800:hover{color:#1e40af}
        .cursor-pointer{cursor:pointer}
        .mt-6{margin-top:1.5rem}
        .text-gray-600{color:#4b5563}
        .mb-4{margin-bottom:1rem}
        .text-xl{font-size:1.25rem;line-height:1.75rem}
        .text-2xl{font-size:1.5rem;line-height:2rem}
        .mb-2{margin-bottom:.5rem}
        .space-x-4>:not([hidden])~:not([hidden]){--tw-space-x-reverse:0;margin-right:calc(1rem * var(--tw-space-x-reverse));margin-left:calc(1rem * calc(1 - var(--tw-space-x-reverse)))}
        .grid{display:grid}
        .grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}
        .gap-6{gap:1.5rem}
        .p-6{padding:1.5rem}
        .rounded-xl{border-radius:.75rem}
        .shadow-lg{box-shadow:0 10px 15px -3px rgba(0,0,0,.1),0 4px 6px -2px rgba(0,0,0,.05)}
        .hover\:shadow-xl:hover{box-shadow:0 20px 25px -5px rgba(0,0,0,.1),0 10px 10px -5px rgba(0,0,0,.04)}
        .transform{transform:var(--tw-transform)}
        .hover\:-translate-y-1:hover{--tw-translate-y:-0.25rem}
        .transition-all{transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}
        .duration-300{transition-duration:.3s}
        .from-green-500{--tw-gradient-from:#10b981;--tw-gradient-stops:var(--tw-gradient-from),var(--tw-gradient-to,rgba(16,185,129,0))}
        .to-emerald-600{--tw-gradient-to:#059669}
        .from-purple-500{--tw-gradient-from:#8b5cf6;--tw-gradient-stops:var(--tw-gradient-from),var(--tw-gradient-to,rgba(139,92,246,0))}
        .to-pink-500{--tw-gradient-to:#ec4899}
        .from-orange-500{--tw-gradient-from:#f97316;--tw-gradient-stops:var(--tw-gradient-from),var(--tw-gradient-to,rgba(249,115,22,0))}
        .to-red-500{--tw-gradient-to:#ef4444}
        .text-4xl{font-size:2.25rem;line-height:2.5rem}
        .mb-3{margin-bottom:.75rem}
        .opacity-90{opacity:.9}
        .relative{position:relative}
        .absolute{position:absolute}
        .right-4{right:1rem}
        .top-1\/2{top:50%}
        .-translate-y-1\/2{--tw-translate-y:-50%}
        .p-3{padding:.75rem}
        .text-gray-400{color:#9ca3af}
        .hover\:text-blue-600:hover{color:#2563eb}
        .hover\:scale-110:hover{--tw-scale-x:1.1;--tw-scale-y:1.1}
        .hover\:bg-blue-50:hover{background-color:#eff6ff}
        .w-7{width:1.75rem}
        .h-7{height:1.75rem}
        .mt-4{margin-top:1rem}
        .py-4{padding-top:1rem;padding-bottom:1rem}
        .px-8{padding-left:2rem;padding-right:2rem}
        .rounded-2xl{border-radius:1rem}
        .hover\:from-blue-700:hover{--tw-gradient-from:#1d4ed8}
        .hover\:to-indigo-700:hover{--tw-gradient-to:#4338ca}
        .text-lg{font-size:1.125rem;line-height:1.75rem}
        .hover\:shadow-xl:hover{box-shadow:0 20px 25px -5px rgba(0,0,0,.1),0 10px 10px -5px rgba(0,0,0,.04)}
        .hover\:-translate-y-1:hover{--tw-translate-y:-0.25rem}
        
        /* Mobile responsive */
        @media (max-width: 768px) {
            .grid-cols-2 { grid-template-columns: 1fr; }
            .max-w-md { max-width: 90%; }
            .p-8 { padding: 1.5rem; }
            .text-3xl { font-size: 1.5rem; line-height: 2rem; }
            .text-2xl { font-size: 1.25rem; line-height: 1.75rem; }
        }
        
        /* Additional styles for better mobile experience */
        .feature-card {
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .feature-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 25px -5px rgba(0,0,0,.1), 0 10px 10px -5px rgba(0,0,0,.04);
        }
    </style>
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#3B82F6">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="LexiLog">
    
    <!-- Firebase Scripts -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Authentication Views -->
    <!-- Login View -->
    <div id="loginView" class="fixed inset-0 bg-gray-50 z-50 flex items-center justify-center">
        <div class="bg-white p-8 rounded-2xl shadow-2xl max-w-md w-full">
            <div class="text-center mb-8">
                <h1 class="text-3xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent mb-2">
                    Welcome to LexiLog
                </h1>
                <p class="text-gray-600">Your Personal Vocabulary Builder</p>
            </div>
            
            <form id="loginForm" class="space-y-4">
                <div>
                    <label for="loginEmail" class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                    <input type="email" id="loginEmail" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                </div>
                
                <div>
                    <label for="loginPassword" class="block text-sm font-medium text-gray-700 mb-2">Password</label>
                    <input type="password" id="loginPassword" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                </div>
                
                <button type="submit" id="loginButton" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-4 rounded-lg transition-colors">
                    Sign In
                </button>
            </form>
            
            <div class="mt-6 text-center">
                <p class="text-gray-600">Don't have an account? 
                    <button id="showSignupBtn" class="text-blue-600 hover:text-blue-800 font-semibold cursor-pointer">Sign up</button>
                </p>
            </div>
        </div>
    </div>

    <!-- Signup View -->
    <div id="signupView" class="hidden fixed inset-0 bg-gray-50 z-50 flex items-center justify-center">
        <div class="bg-white p-8 rounded-2xl shadow-2xl max-w-md w-full">
            <div class="text-center mb-6">
                <h1 class="text-2xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent mb-2">
                    Join LexiLog
                </h1>
                <p class="text-gray-600">Start building your vocabulary today</p>
            </div>
            
            <form id="signupForm" class="space-y-4">
                <div>
                    <label for="signupName" class="block text-sm font-medium text-gray-700 mb-2">Full Name</label>
                    <input type="text" id="signupName" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                </div>
                
                <div>
                    <label for="signupEmail" class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                    <input type="email" id="signupEmail" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                </div>
                
                <div>
                    <label for="signupPassword" class="block text-sm font-medium text-gray-700 mb-2">Password</label>
                    <input type="password" id="signupPassword" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                </div>
                
                <div>
                    <label for="signupQuestion" class="block text-sm font-medium text-gray-700 mb-2">
                        What are you preparing for?
                    </label>
                    <select 
                        id="signupQuestion" 
                        name="goal" 
                        required
                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                    >
                        <option value="">Select your goal</option>
                        <option value="cat">🐯 CAT (Common Admission Test)</option>
                        <option value="gre">🎓 GRE (Graduate Record Examination)</option>
                        <option value="gmat">📊 GMAT (Graduate Management Admission Test)</option>
                        <option value="upsc">🏛️ UPSC Civil Services</option>
                        <option value="banking">🏦 Banking Exams (IBPS, SBI PO/Clerk)</option>
                        <option value="ssc">📝 SSC Exams (CGL, CHSL, MTS)</option>
                        <option value="gate">⚙️ GATE (Graduate Aptitude Test in Engineering)</option>
                        <option value="ielts">🌍 IELTS (International English Language Testing System)</option>
                        <option value="toefl">🇺🇸 TOEFL (Test of English as a Foreign Language)</option>
                        <option value="sat">📚 SAT (Scholastic Assessment Test)</option>
                        <option value="act">📝 ACT (American College Testing)</option>
                        <option value="clat">⚖️ CLAT (Common Law Admission Test)</option>
                        <option value="neet">🏥 NEET (National Eligibility cum Entrance Test)</option>
                        <option value="jee">🔬 JEE (Joint Entrance Examination)</option>
                        <option value="vocabulary-building">📖 Just Building My Vocabulary</option>
                        <option value="other">✏️ Other</option>
                    </select>
                </div>
                
                <div id="otherGoalField" class="hidden">
                    <label for="signupOtherGoal" class="block text-sm font-medium text-gray-700 mb-2">
                        Please specify your exam/goal:
                    </label>
                    <input 
                        type="text" 
                        id="signupOtherGoal" 
                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        placeholder="e.g., UPSC, CAT 2024, etc."
                    >
                </div>
                
                <button type="submit" id="signupButton" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-4 rounded-lg transition-colors">
                    Create Account
                </button>
            </form>
            
            <div class="mt-6 text-center">
                <p class="text-gray-600">Already have an account? 
                    <button id="showLoginBtn" class="text-blue-600 hover:text-blue-800 font-semibold cursor-pointer">Sign in</button>
                </p>
            </div>
        </div>
    </div>

    <!-- Main App -->
    <div id="mainApp" class="hidden">
        <!-- Homepage -->
        <div id="homeView" class="min-h-screen bg-gray-50 flex items-center justify-center p-8">
            <div class="max-w-4xl w-full text-center">
                <div class="mb-8">
                    <h1 id="greeting" class="text-4xl font-bold mb-3">
                        <span class="bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent">
                            Welcome to LexiLog!
                        </span>
                    </h1>
                    <p class="text-xl text-gray-600 opacity-90">Your Personal Vocabulary Builder</p>
                </div>
                
                <div class="grid grid-cols-2 gap-6 max-w-2xl mx-auto">
                    <div class="feature-card bg-gradient-to-br from-blue-500 to-blue-600 text-white p-6 rounded-xl shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all duration-300" data-navigate="dictionary">
                        <div class="text-4xl mb-3">📚</div>
                        <h3 class="text-xl font-semibold mb-2">Smart Dictionary</h3>
                        <p class="opacity-90">Search English words with definitions, phonetics, and audio</p>
                    </div>
                    
                    <div class="feature-card bg-gradient-to-br from-green-500 to-emerald-600 text-white p-6 rounded-xl shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all duration-300" data-navigate="library">
                        <div class="text-4xl mb-3">📖</div>
                        <h3 class="text-xl font-semibold mb-2">My LexiLog</h3>
                        <p class="opacity-90">Access your saved vocabulary and track progress</p>
                    </div>
                    
                    <div class="feature-card bg-gradient-to-br from-purple-500 to-pink-500 text-white p-6 rounded-xl shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all duration-300" data-navigate="languages">
                        <div class="text-4xl mb-3">🌍</div>
                        <h3 class="text-xl font-semibold mb-2">Multi-Language</h3>
                        <p class="opacity-90">Search words in 20+ languages with translations</p>
                    </div>
                    
                    <div class="feature-card bg-gradient-to-br from-orange-500 to-red-500 text-white p-6 rounded-xl shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all duration-300" data-navigate="daily">
                        <div class="text-4xl mb-3">⭐</div>
                        <h3 class="text-xl font-semibold mb-2">Word of the Day</h3>
                        <p class="opacity-90">Discover and learn a new word every day</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Dictionary View -->
        <div id="dictionaryView" class="hidden min-h-screen bg-gray-50 p-8">
            <div class="max-w-2xl mx-auto">
                <div class="text-center mb-8">
                    <h2 class="text-3xl font-bold text-gray-800 mb-2">📚 Smart Dictionary</h2>
                    <p class="text-gray-600">Search for English words with detailed definitions</p>
                </div>
                
                <div class="bg-white rounded-2xl shadow-lg p-6 mb-6">
                    <div class="relative">
                        <input 
                            type="text" 
                            id="searchInput" 
                            placeholder="Type any English word..."
                            class="w-full px-6 py-4 pr-20 text-lg border-2 border-gray-200 rounded-2xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                        >
                        <button 
                            id="audioButton" 
                            class="absolute right-4 top-1/2 transform -translate-y-1/2 p-3 text-gray-400 hover:text-blue-600 transition-all duration-300 hover:scale-110 rounded-xl hover:bg-blue-50"
                            title="🎤 Voice Search"
                        >
                            <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"></path>
                            </svg>
                        </button>
                    </div>
                    <button 
                        id="searchButton" 
                        class="w-full mt-4 bg-gradient-to-r from-blue-600 to-indigo-600 text-white py-4 px-8 rounded-2xl hover:from-blue-700 hover:to-indigo-700 transition-all duration-300 font-semibold text-lg shadow-lg hover:shadow-xl transform hover:-translate-y-1"
                    >
                        🔍 Search & Learn
                    </button>
                </div>
                
                <!-- Search Results -->
                <div id="searchResults" class="hidden bg-white rounded-2xl shadow-lg p-6">
                    <div class="text-center mb-4">
                        <h3 id="resultWord" class="text-2xl font-bold text-gray-800"></h3>
                        <p id="resultPhonetic" class="text-gray-600"></p>
                    </div>
                    <div id="resultDefinitions" class="space-y-4"></div>
                </div>
                
                <!-- Loading State -->
                <div id="loadingState" class="hidden text-center py-8">
                    <div class="text-blue-600 text-lg">🔄 Searching...</div>
                </div>
                
                <!-- Error State -->
                <div id="errorState" class="hidden text-center py-8">
                    <div class="text-red-600 text-lg">❌ Word not found. Please try another word.</div>
                </div>
            </div>
        </div>

        <!-- Other views would go here but keeping minimal for now -->
        <div id="languagesView" class="hidden min-h-screen bg-gray-50 p-8">
            <div class="text-center">
                <h2 class="text-3xl font-bold text-gray-800 mb-4">🌍 Multi-Language Search</h2>
                <p class="text-gray-600">Coming soon...</p>
            </div>
        </div>

        <div id="libraryView" class="hidden min-h-screen bg-gray-50 p-8">
            <div class="text-center">
                <h2 class="text-3xl font-bold text-gray-800 mb-4">📖 My LexiLog</h2>
                <p class="text-gray-600">Your vocabulary library coming soon...</p>
            </div>
        </div>

        <div id="dailyView" class="hidden min-h-screen bg-gray-50 p-8">
            <div class="text-center">
                <h2 class="text-3xl font-bold text-gray-800 mb-4">⭐ Word of the Day</h2>
                <p class="text-gray-600">Daily word feature coming soon...</p>
            </div>
        </div>
    </div>

    <!-- Minimal JavaScript for core functionality -->
    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyByQABCkc1kQgSZevk30UKWQe3dq0bhHbs",
            authDomain: "lexilog-c1559.firebaseapp.com",
            projectId: "lexilog-c1559",
            storageBucket: "lexilog-c1559.firebasestorage.app",
            messagingSenderId: "383823777893",
            appId: "1:383823777893:web:ffe084adfbf2d1ee7cf68c",
            measurementId: "G-QXMEFRQ36N"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        // Global variables
        let currentUser = null;
        let currentUserId = null;

        // DOM elements
        const elements = {
            loginView: document.getElementById('loginView'),
            signupView: document.getElementById('signupView'),
            mainApp: document.getElementById('mainApp'),
            loginForm: document.getElementById('loginForm'),
            signupForm: document.getElementById('signupForm'),
            homeView: document.getElementById('homeView'),
            dictionaryView: document.getElementById('dictionaryView'),
            languagesView: document.getElementById('languagesView'),
            libraryView: document.getElementById('libraryView'),
            dailyView: document.getElementById('dailyView'),
            searchInput: document.getElementById('searchInput'),
            searchButton: document.getElementById('searchButton'),
            searchResults: document.getElementById('searchResults'),
            loadingState: document.getElementById('loadingState'),
            errorState: document.getElementById('errorState'),
            resultWord: document.getElementById('resultWord'),
            resultPhonetic: document.getElementById('resultPhonetic'),
            resultDefinitions: document.getElementById('resultDefinitions'),
            greeting: document.getElementById('greeting'),
            signupQuestion: document.getElementById('signupQuestion'),
            signupOtherGoal: document.getElementById('signupOtherGoal'),
            otherGoalField: document.getElementById('otherGoalField')
        };

        // Navigation function
        function navigateToView(viewName) {
            const views = ['home', 'dictionary', 'languages', 'library', 'daily'];
            
            // Hide all views
            views.forEach(view => {
                const viewElement = elements[`${view}View`];
                if (viewElement) {
                    viewElement.classList.add('hidden');
                }
            });
            
            // Show target view
            const targetView = elements[`${viewName}View`];
            if (targetView) {
                targetView.classList.remove('hidden');
            }
        }

        // Authentication functions
        function showLogin() {
            elements.loginView.classList.remove('hidden');
            elements.signupView.classList.add('hidden');
            elements.mainApp.classList.add('hidden');
        }

        function showSignup() {
            elements.signupView.classList.remove('hidden');
            elements.loginView.classList.add('hidden');
            elements.mainApp.classList.add('hidden');
        }

        function showMainApp(userProfile) {
            elements.loginView.classList.add('hidden');
            elements.signupView.classList.add('hidden');
            elements.mainApp.classList.remove('hidden');
            
            if (userProfile && elements.greeting) {
                const firstName = userProfile.name.split(' ')[0];
                elements.greeting.innerHTML = `<span class="bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent">Welcome to LexiLog, ${firstName}!</span>`;
            }
            
            navigateToView('home');
        }

        // Search function
        async function searchEnglishWord(word) {
            if (!word.trim()) return;
            
            elements.loadingState.classList.remove('hidden');
            elements.searchResults.classList.add('hidden');
            elements.errorState.classList.add('hidden');
            
            try {
                const response = await fetch(`https://api.dictionaryapi.dev/api/v2/entries/en/${encodeURIComponent(word.trim())}`);
                if (response.ok) {
                    const data = await response.json();
                    if (data && data.length > 0) {
                        displaySearchResults(data[0]);
                    } else {
                        throw new Error('Word not found');
                    }
                } else {
                    throw new Error('Word not found');
                }
            } catch (error) {
                console.error('Search error:', error);
                elements.errorState.classList.remove('hidden');
            } finally {
                elements.loadingState.classList.add('hidden');
            }
        }

        function displaySearchResults(wordData) {
            elements.resultWord.textContent = wordData.word;
            elements.resultPhonetic.textContent = wordData.phonetic || '';
            
            elements.resultDefinitions.innerHTML = '';
            wordData.meanings.forEach(meaning => {
                const meaningDiv = document.createElement('div');
                meaningDiv.className = 'p-4 bg-gray-50 rounded-lg';
                meaningDiv.innerHTML = `
                    <div class="text-sm text-blue-600 font-semibold mb-2">${meaning.partOfSpeech}</div>
                    <div class="text-gray-800 mb-2">${meaning.definitions[0].definition}</div>
                    ${meaning.definitions[0].example ? `<div class="text-gray-600 italic">"${meaning.definitions[0].example}"</div>` : ''}
                `;
                elements.resultDefinitions.appendChild(meaningDiv);
            });
            
            elements.searchResults.classList.remove('hidden');
        }

        // Initialize app
        document.addEventListener('DOMContentLoaded', () => {
            // Auth state listener
            auth.onAuthStateChanged(async (user) => {
                if (user) {
                    currentUser = user;
                    currentUserId = user.uid;
                    
                    try {
                        const doc = await db.collection('artifacts').doc('lexilog-vocabulary-builder')
                            .collection('users').doc(currentUserId)
                            .collection('profile').doc('data').get();
                        
                        if (doc.exists) {
                            showMainApp(doc.data());
                        } else {
                            showMainApp({ name: user.email || 'User' });
                        }
                    } catch (error) {
                        showMainApp({ name: user.email || 'User' });
                    }
                } else {
                    showLogin();
                }
            });

            // Event listeners
            document.getElementById('showSignupBtn').addEventListener('click', showSignup);
            document.getElementById('showLoginBtn').addEventListener('click', showLogin);

            // Login form
            elements.loginForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const email = document.getElementById('loginEmail').value.trim();
                const password = document.getElementById('loginPassword').value;
                
                try {
                    await auth.signInWithEmailAndPassword(email, password);
                } catch (error) {
                    alert('Login failed: ' + error.message);
                }
            });

            // Signup form
            elements.signupForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const name = document.getElementById('signupName').value.trim();
                const email = document.getElementById('signupEmail').value.trim();
                const password = document.getElementById('signupPassword').value;
                const goal = elements.signupQuestion.value;
                const otherGoal = elements.signupOtherGoal.value.trim();
                
                try {
                    const result = await auth.createUserWithEmailAndPassword(email, password);
                    
                    // Save profile
                    await db.collection('artifacts').doc('lexilog-vocabulary-builder')
                        .collection('users').doc(result.user.uid)
                        .collection('profile').doc('data').set({
                            name: name,
                            email: email,
                            goal: goal,
                            otherGoal: otherGoal,
                            createdAt: firebase.firestore.FieldValue.serverTimestamp()
                        });
                        
                    alert('Account created successfully!');
                } catch (error) {
                    alert('Signup failed: ' + error.message);
                }
            });

            // Goal selector
            if (elements.signupQuestion) {
                elements.signupQuestion.addEventListener('change', (e) => {
                    if (e.target.value === 'other') {
                        elements.otherGoalField.classList.remove('hidden');
                        elements.signupOtherGoal.required = true;
                    } else {
                        elements.otherGoalField.classList.add('hidden');
                        elements.signupOtherGoal.required = false;
                        elements.signupOtherGoal.value = '';
                    }
                });
            }

            // Search functionality
            elements.searchButton.addEventListener('click', () => {
                const word = elements.searchInput.value.trim();
                if (word) {
                    searchEnglishWord(word);
                }
            });

            elements.searchInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    const word = elements.searchInput.value.trim();
                    if (word) {
                        searchEnglishWord(word);
                    }
                }
            });

            // Feature card navigation
            const featureCards = document.querySelectorAll('.feature-card[data-navigate]');
            featureCards.forEach(card => {
                card.addEventListener('click', () => {
                    const targetView = card.getAttribute('data-navigate');
                    navigateToView(targetView);
                });
            });
        });

        // Global functions
        window.navigateToView = navigateToView;
    </script>
</body>
</html>
